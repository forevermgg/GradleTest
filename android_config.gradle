def getGitBranch() {
    try {
        def stdout = new ByteArrayOutputStream()
        exec {
            commandLine 'git', 'rev-parse', '--abbrev-ref', 'HEAD'
            standardOutput = stdout
        }
        return stdout.toString().trim()
    } catch (exception) {
        exception.printStackTrace()
        return "unkown"
    }
}

def getGitHash() {
    try {
        def stdout = new ByteArrayOutputStream()
        exec {
            commandLine 'git', 'log', '--pretty=format:%h', '-n 1'
            standardOutput = stdout
        }
        return stdout.toString().trim()
    } catch (exception) {
        exception.printStackTrace()
        return "unkown"
    }
}

def gitGitVersionCode() {
    try {
        return 'git rev-list HEAD --first-parent --count'.execute().text.trim().toInteger()
    }
    catch (ignored) {
        return 1
    }
}

ext {
    minSdkVersion = 21
    compileSdkVersion = 33
    targetSdkVersion = 33
    buildToolsVersion = "33.0.0"
    javaVersion = JavaVersion.VERSION_1_7
    ndkVersion = "25.1.8937393"
    cmakeVersion = "3.22.1"
    abiFilters = "armeabi-v7a,arm64-v8a,x86,x86_64"
    useASAN = false
    dependencyOnLocalLibrary = true
    gitBranch = getGitBranch()
    gitCommitId = getGitHash()
    gitGitVersionCode = gitGitVersionCode()
}

qci {
    iSCI = false
}